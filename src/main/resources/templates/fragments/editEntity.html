<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Edit</title>
</head>
<body>
<div th:fragment="edit-form" xmlns:th="http://www.thymeleaf.org" th:remove="tag">
    <form method="post" class="form-group" th:object="${entity}" id="entityForm" th:action="@{/save}">
        <div class="col-xs-12 col-sm-8 col-md-6 col-sm-offset-2 col-md-offset-3">
            <form method="post" class="form-group" th:object="${entity}" id="entityForm" th:action="@{/save}">
                <div th:each="caption:${captions}" th:if="${!caption.hide&&!caption.masked&&caption.type!='boolean'}"
                     class="form-group">
                    <label th:text="${caption.label}"></label>
                    <input type="text" th:field="*{__${caption.name}__}" class="form-control input">
                </div>
                <div th:each="caption:${captions}" th:if="${caption.masked}" class="form-group">
                    <label th:text="${caption.label}"></label>
                    <input type="password" th:field="*{__${caption.name}__}" class="form-control input">
                </div>
                <div th:each="caption:${captions}" th:if="${!caption.hide&&caption.type=='boolean'}" class="form-group">
                    <label th:text="${caption.label}"></label>
                    <input type="checkbox" th:field="*{__${caption.name}__}" class="form-control input">
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary btn-block" id="submit">Save</button>
                </div>
            </form>
        </div>
    </form>
    <script th:inline="javascript">
        var getUrlParameter = function getUrlParameter(sParam) {
            var sPageURL = window.location.search.substring(1),
                sURLVariables = sPageURL.split('&'),
                sParameterName,
                i;

            for (i = 0; i < sURLVariables.length; i++) {
                sParameterName = sURLVariables[i].split('=');

                if (sParameterName[0] === sParam) {
                    return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
                }
            }
        };

        /*<![CDATA[*/
        $("#entityForm").submit(function (e) {
            e.preventDefault();
            console.log(JSON.stringify($("#entityForm").serializeArray()));
            $.ajax({
                url: $("#entityForm").attr('action') + "?entityClass=" + getUrlParameter("entityClass"),
                type: 'post',
                data: $("#entityForm").serializeArray(),
                success: function (response) {
                    window.location.reload();
                }
            })
        });/*]]>*/
    </script>
</div>
</body>
</html>